var app;(()=>{var e={1735:(e,r,t)=>{const i=t(6860),n=t(2986),s=t(2265),o=t(3179),a=i.Router();a.get("/institution/info",n.isEmployee,s.organizationInfo),a.post("/institution/info/update",n.isEmployee,s.organizationInfoUpdate),a.get("/institution/faculties",n.isEmployee,s.facultiesList),a.post("/institution/faculties/add",n.isEmployee,s.facultyAdd),a.post("/institution/faculties/update",n.isEmployee,s.facultyUpdate),a.delete("/institution/faculties/delete",n.isEmployee,s.facultyDelete),a.get("/institution/directions",n.isEmployee,s.directionsList),a.post("/institution/directions/add",n.isEmployee,s.directionAdd),a.post("/institution/directions/update",n.isEmployee,s.directionUpdate),a.delete("/institution/directions/delete",n.isEmployee,s.directionDelete),a.get("/institution/specialties",n.isEmployee,s.specialtiesList),a.post("/institution/specialties/add",n.isEmployee,s.specialtyAdd),a.post("/institution/specialties/update",n.isEmployee,s.specialtyUpdate),a.delete("/institution/specialties/delete",n.isEmployee,s.specialtyDelete),a.get("/institution/plan",n.isEmployee,s.plansList),a.get("/institution/employees",n.isEmployee,s.employeesList),a.post("/institution/employees/save",n.isEmployee,s.employeeSave),a.delete("/institution/employees/delete",n.isEmployee,s.employeeDelete),a.post("/institution/employees/reset-password",n.isEmployee,s.employeeResetPassword),a.get("/institution/employees/faculties",n.isEmployee,s.employeeFacultiesList),a.post("/institution/employees/faculty/save",n.isEmployee,s.employeeFacultySave),a.delete("/institution/employees/faculty/delete",n.isEmployee,s.employeeFacultyDelete),a.get("/education/level",n.isEmployee,o.levelsList),a.get("/education/industry",n.isEmployee,o.industriesList),a.get("/education/discipline",n.isEmployee,o.disciplinesList),a.get("/education/discipline/control",n.isEmployee,o.disciplineControlList),a.get("/education/discipline/type",n.isEmployee,o.disciplineTypesList),a.get("/education/period/years",n.isEmployee,o.periodYearsList),a.get("/education/period/months",n.isEmployee,o.periodMonthsList),e.exports=a},3179:(e,r,t)=>{const{send:i,sendError:n,sendSuccess:s}=t(5096),o=(t(548),t(3611)),a=(t(2830),t(2919)),{updatePassword:c}=(t(7092),t(6282)),u=t(6695),d=t(677);e.exports=new class{async levelsList(e,r){try{const e=await d.levelsList();return e?s(r,e,"Education level list returned successfully."):n(r,"An error occurred while get education level.")}catch(e){return console.error(e),n(r,"An error occurred while get education level.")}}async industriesList(e,r){try{const t=e.i18n.resolvedLanguage,i=await a.getLangId(t),o=await d.industriesList({language:i});return o?s(r,o,"Industry list list returned successfully."):n(r,"An error occurred while get industry list.")}catch(e){return console.error(e),n(r,"An error occurred while get industry list.")}}async disciplinesList(e,r){try{if(!o(e.query,u.disciplinesList))return n(r,"Invalid request query. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await a.getLangId(t),{id_org:c}=e.query,l=await d.disciplinesList({language:i,id_org:parseInt(c)});return l?s(r,l,"Discipline list returned successfully."):n(r,"An error occurred while get discipline.")}catch(e){return console.error(e),n(r,"An error occurred while get discipline.")}}async disciplineControlList(e,r){try{const t=e.i18n.resolvedLanguage,i=await a.getLangId(t),o=await d.disciplineControlList({language:i});return o?s(r,o,"Discipline control list returned successfully."):n(r,"An error occurred while get discipline control.")}catch(e){return console.error(e),n(r,"An error occurred while get discipline control.")}}async disciplineTypesList(e,r){try{const t=e.i18n.resolvedLanguage,i=await a.getLangId(t),o=await d.disciplineTypesList({language:i});return o?s(r,o,"Discipline type list returned successfully."):n(r,"An error occurred while get discipline type.")}catch(e){return console.error(e),n(r,"An error occurred while get discipline type.")}}async periodYearsList(e,r){try{const e=await d.periodYearsList();return e?s(r,e,"Period years list returned successfully."):n(r,"An error occurred while get period years.")}catch(e){return console.error(e),n(r,"An error occurred while get period years.")}}async periodMonthsList(e,r){try{const e=await d.periodMonthsList();return e?s(r,e,"Period months list returned successfully."):n(r,"An error occurred while get period months.")}catch(e){return console.error(e),n(r,"An error occurred while get period months.")}}}},6695:e=>{e.exports={disciplinesList:{type:"object",properties:{id_org:{type:"string",required:!0}}}}},677:(e,r,t)=>{const i=t(6427),n=t(3148);e.exports={levelsList:async function(){try{const{rows:e}=await i.query("SELECT * FROM fn_education_level()",[]);return e}catch(e){return n.error(`Error get education level list: ${e.message}`),!1}},industriesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_industry(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get industry list: ${e.message}`),!1}},disciplinesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_discipline(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get discipline list: ${e.message}`),!1}},disciplineControlList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_discipline_control(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get discipline control list: ${e.message}`),!1}},disciplineTypesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_discipline_type(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get discipline type list: ${e.message}`),!1}},periodYearsList:async function(){try{const{rows:e}=await i.query("SELECT * FROM fn_education_period_year()",[]);return e}catch(e){return n.error(`Error get education period years list: ${e.message}`),!1}},periodMonthsList:async function(){try{const{rows:e}=await i.query("SELECT * FROM fn_education_period_month()",[]);return e}catch(e){return n.error(`Error get education period months list: ${e.message}`),!1}}}},6559:(e,r,t)=>{const i=t(1735);e.exports=i},2265:(e,r,t)=>{const i=t(4170);e.exports=i},4170:(e,r,t)=>{const{send:i,sendError:n,sendSuccess:s}=t(5096),o=(t(548),t(3611)),a=t(2830),{sendMessage:c}=t(4972),u=t(2919),d=t(7092),{updatePassword:l}=t(6282),p=t(3522),y=t(9345),{passwordMessage:g}=t(7934);e.exports=new class{async organizationInfo(e,r){try{if(!o(e.query,p.organizationInfo))return n(r,"Invalid query parameters. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),{org_id:a,org_okpo:c}=e.query,d=await y.organizationInfo({language:i,org_id:a,org_okpo:c});return d?s(r,d,"Success"):n(r,"Organization information not found for the provided OKPO.")}catch(e){return console.error(e),n(r,"An unexpected error occurred while fetching organization information.")}}async organizationInfoUpdate(e,r){try{if(!o(e.body,p.organizationInfoUpdate))return n(r,"Invalid request body. Please check the expected format.");const{id_org:t,okpo:i,s_org:a,org_ky:c,org_ru:u,org_en:d,id_region:l,id_district:g,id_org_type:m,longitude:f,latitude:_}=e.body,h=await y.organizationInfoUpdate({id_org:t,okpo:i,s_org:a,org_ky:c,org_ru:u,org_en:d,id_region:l,id_district:g,id_org_type:m,longitude:f,latitude:_});return h?s(r,h,"Organization information updated successfully."):n(r,"An error occurred while updating organization information.")}catch(e){return console.error(e),n(r,"An unexpected error occurred while updating organization information.")}}async facultiesList(e,r){try{if(!e.query.id_org&&!e.user.org)return n(r,"Invalid query parameters. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),{org_id:o}=e.query,a=await y.facultiesList({language:i,org_id:o});return a?s(r,a,"Organization faculties list returned successfully."):n(r,"An error occurred while get organization faculties.")}catch(e){return console.error(e),n(r,"An error occurred while get organization faculties.")}}async facultyAdd(e,r){try{if(!o(e.body,p.facultySave))return n(r,"Invalid request body. Please check the expected format.");const{s_faculty:t,faculty_ky:i,faculty_ru:a,faculty_en:c,id_org:u}=e.body,d=await y.facultySave({id_faculty:0,s_faculty:t,faculty_ky:i,faculty_ru:a,faculty_en:c,id_org:u});return d?s(r,d,"Organization faculty added successfully."):n(r,"An error occurred while adding organization faculty.")}catch(e){return console.error(e),n(r,"An error occurred while adding organization faculty.")}}async facultyUpdate(e,r){try{if(!o(e.body,p.facultySave))return n(r,"Invalid request body. Please check the expected format.");if(!e.body.id_faculty)return n(r,"Faculty not found for update");const{id_faculty:t,s_faculty:i,faculty_ky:a,faculty_ru:c,faculty_en:u,id_org:d}=e.body,l=await y.facultySave({id_faculty:t,s_faculty:i,faculty_ky:a,faculty_ru:c,faculty_en:u,id_org:d});return l?s(r,l,"Organization faculty updated successfully."):n(r,"An error occurred while updating organization faculty.")}catch(e){return console.error(e),n(r,"An error occurred while updating organization faculty.")}}async facultyDelete(e,r){try{if(!o(e.query,p.facultyDelete))return n(r,"Invalid request query. Please check the expected format.");const{id_faculty:t}=e.query,i=e.user.id;if(!i)return n(r,"User not found");const a=await y.facultyDelete({id_users:parseInt(i),id_faculty:parseInt(t)});return a?s(r,a,"Organization faculty deleted successfully."):n(r,"An error occurred while deleting organization faculty.")}catch(e){return console.error(e),n(r,"An error occurred while deleting organization faculty.")}}async directionsList(e,r){try{if(!o(e.query,p.directionsList))return n(r,"Invalid query parameters. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),{faculty_id:a}=e.query,c=await y.directionsList({language:i,faculty_id:a});return c?s(r,c,"Organization faculties directions list returned successfully."):n(r,"An error occurred while get organization faculties directions.")}catch(e){return console.error(e),n(r,"An error occurred while get organization faculties directions.")}}async directionAdd(e,r){try{if(!o(e.body,p.directionSave))return n(r,"Invalid request body. Please check the expected format.");const{faculty_id:t,direction_cipher:i,direction_ky:a,direction_ru:c,direction_en:u}=e.body,d=await y.directionSave({id_direction:0,faculty_id:t,direction_cipher:i,direction_ky:a,direction_ru:c,direction_en:u});return d?s(r,d,"Organization faculty direction added successfully."):n(r,"An error occurred while adding organization faculty direction.")}catch(e){return console.error(e),n(r,"An error occurred while adding organization faculty direction.")}}async directionUpdate(e,r){try{if(!o(e.body,p.directionSave))return n(r,"Invalid request body. Please check the expected format.");if(!e.body.id_direction)return n(r,"Direction not found for update");const{id_direction:t,faculty_id:i,direction_cipher:a,direction_ky:c,direction_ru:u,direction_en:d}=e.body,l=await y.directionSave({id_direction:t,faculty_id:i,direction_cipher:a,direction_ky:c,direction_ru:u,direction_en:d});return l?s(r,l,"Organization faculty direction updated successfully."):n(r,"An error occurred while updating organization faculty direction.")}catch(e){return console.error(e),n(r,"An error occurred while updating organization faculty direction.")}}async directionDelete(e,r){try{if(!o(e.query,p.directionDelete))return n(r,"Invalid request query. Please check the expected format.");const{id_direction:t}=e.query,i=e.user.id;if(!i)return n(r,"User not found");const a=await y.directionDelete({id_users:parseInt(i),id_direction:parseInt(t)});return a?s(r,a,"Organization faculty direction deleted successfully."):n(r,"An error occurred while deleting organization faculty direction.")}catch(e){return console.error(e),n(r,"An error occurred while deleting organization faculty direction.")}}async specialtiesList(e,r){try{if(!o(e.query,p.specialtiesList))return n(r,"Invalid query parameters. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),{id_direction:a}=e.query,c=await y.specialtyList({language:i,id_direction:a});return c?s(r,c,"Organization specialties list returned successfully."):n(r,"An error occurred while get organization specialties.")}catch(e){return console.error(e),n(r,"An error occurred while get organization specialties.")}}async specialtyAdd(e,r){try{if(!o(e.body,p.specialtySave))return n(r,"Invalid request body. Please check the expected format.");const{specialty_cipher:t,specialty_ky:i,specialty_ru:a,specialty_en:c,id_learning:u,id_industry:d,id_qualification:l,id_direction:g,id_education_period_year:m,id_education_period_month:f}=e.body,_=await y.specialtySave({specialty_id:0,direction_id:g,learning_id:u,industry_id:d,spec_cipher:t,spec_ky:i,spec_ru:a,spec_en:c,qualification_id:l,id_education_period_year:m,id_education_period_month:f});return _?s(r,_,"Organization faculty specialty added successfully."):n(r,"An error occurred while adding organization faculty specialty.")}catch(e){return console.error(e),n(r,"An error occurred while adding organization faculty specialty.")}}async specialtyUpdate(e,r){try{if(!o(e.body,p.specialtySave))return n(r,"Invalid request body. Please check the expected format.");if(!e.body.id_specialty)return n(r,"Specialty not found for update");const{id_specialty:t,specialty_cipher:i,specialty_ky:a,specialty_ru:c,specialty_en:u,id_learning:d,id_industry:l,id_qualification:g,id_direction:m,id_education_period_year:f,id_education_period_month:_}=e.body,h=await y.specialtySave({specialty_id:t,direction_id:m,learning_id:d,industry_id:l,spec_cipher:i,spec_ky:a,spec_ru:c,spec_en:u,qualification_id:g,id_education_period_year:f,id_education_period_month:_});return h?s(r,h,"Organization faculty specialty added successfully."):n(r,"An error occurred while adding organization faculty specialty.")}catch(e){return console.error(e),n(r,"An error occurred while adding organization faculty specialty.")}}async specialtyDelete(e,r){try{if(!o(e.query,p.specialtyDelete))return n(r,"Invalid request query. Please check the expected format.");if(!e.query.id_specialty)return n(r,"Specialty not found for delete");const t=e.user.id;if(!t)return n(r,"User not found");const{id_specialty:i}=e.query,a=await y.specialtyDelete({id_users:t,id_specialty:parseInt(i)});return a?s(r,a,"Organization faculty specialty deleted successfully."):n(r,"An error occurred while deleting organization faculty specialty.")}catch(e){return console.error(e),n(r,"An error occurred while deleting organization faculty specialty.")}}async plansList(e,r){try{if(!o(e.query,p.plansList))return n(r,"Invalid request query. Please check the expected format.");const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),{years_id:a,specialty_id:c,id_education_level:d,id_org:l}=e.query,g=l||e.user.org,m=await y.plansList({language:i,org_id:parseInt(g),years_id:parseInt(a),specialty_id:parseInt(c),education_level_id:parseInt(d)});return m?s(r,m,"Education level list returned successfully."):n(r,"An error occurred while get education level.")}catch(e){return console.error(e),n(r,"An error occurred while get education level.")}}async employeesList(e,r){try{const t=e.query.id_org||e.user.org;if(!t)return n(r,"Invalid request query. Please check the expected format.");const i=await y.employeesList({id_org:parseInt(t)});return i?s(r,i,"Employee list returned successfully."):n(r,"An error occurred while get employees list.")}catch(e){return console.error(e),n(r,"An error occurred while get employees list.")}}async employeeSave(e,r){try{if(!o(e.body,p.employeeSave))return n(r,"Invalid request body. Please check the expected format.");const t=e.user.org,i=e.user.okpo,{id_users:u,id_org:l,surname:m,name:f,patronymic:_,birth_date:h,pin:E,active:w,okpo:S,email:O,telephone:L}=e.body,b=!u,q=await d.getUserById(u);if(!b&&(t!==q.id_org||i!==q.okpo))return n(r,"Do not have a permission to save this user");const{password:I}=await a.generatePassword(),v=await a.md5(I),x=b?v:q.password,A=b?w:q.active,$=i??S,T=await y.employeeSave({id_users:u,id_org:parseInt(t)??parseInt(l),surname:m,name:f,patronymic:_,birth_date:h,pin:E,active:A,okpo:$,email:O,telephone:L,password:x});return T?(b&&await c({email:O,message:g(I)}),s(r,T,"Employee list returned successfully.")):n(r,"An error occurred while get employees list.")}catch(e){return console.error(e),n(r,"An error occurred while get employees list.")}}async employeeDelete(e,r){try{const t=e.user.id,i=e.query.users_id;if(!i)return n(r,"Invalid request query. Please check the expected format.");const o=await y.employeeDelete({id_users:parseInt(t),users_id:parseInt(i)});return o?s(r,o,"Employee deleted successfully."):n(r,"An error occurred while delete employee.")}catch(e){return console.error(e),n(r,"An error occurred while delete employee.")}}async employeeResetPassword(e,r){try{if(!e.body.id_user)return n(r,"Invalid body parameters. Please check the expected format.");const{id_user:t}=e.body,{password:i}=await a.generatePassword(),o=await a.md5(i),u=await d.getUserById(t),p=(`${u.surname} ${u.name} ${u?.patronymic??""}`.trim(),u.email),y=await l(t,o);if(u&&y){const e=await c({email:p,message:g(p)});return s(r,e,"Success")}return n(r,"Employee reset password error.")}catch(e){return console.error(e),n(r,"An unexpected error occurred while fetching reset password employee.")}}async employeeFacultiesList(e,r){try{const t=e.query.id_org||e.user.org;if(!t)return n(r,"Invalid request query. Please check the expected format.");const i=await y.employeeFacultiesList({id_org:parseInt(t)});return i?s(r,i,"Employee faculties list returned successfully."):n(r,"An error occurred while get employees faculties list.")}catch(e){return console.error(e),n(r,"An error occurred while get employees faculties list.")}}async employeeFacultySave(e,r){try{const t=e.body.id_users,i=e.body.id_faculty;if(!i)return n(r,"Invalid request body. Please check the expected format.");const o=await y.employeeFacultySave({id_users:parseInt(t),id_faculty:parseInt(i)});return o?s(r,o,"Employee faculties list returned successfully."):n(r,"An error occurred while save employees faculty.")}catch(e){return console.error(e),n(r,"An error occurred while save employees faculty.")}}async employeeFacultyDelete(e,r){try{const t=e.query.id_users,i=e.query.id_faculty;if(!t||!i)return n(r,"Invalid request query. Please check the expected format.");const o=await y.employeeFacultyDelete({id_users:parseInt(t),id_faculty:parseInt(i)});return o?s(r,o,"Employee faculty deleted successfully."):n(r,"An error occurred while delete employee faculty.")}catch(e){return console.error(e),n(r,"An error occurred while delete employee faculty.")}}}},3522:e=>{e.exports={organizationInfo:{type:"object",properties:{org_id:{type:"string",required:!0},org_okpo:{type:"string",required:!0}}},organizationInfoUpdate:{type:"object",properties:{okpo:{type:"string",required:!0},s_org:{type:"string",required:!0},org_ky:{type:"string",required:!0},org_ru:{type:"string",required:!0},org_en:{type:"string",required:!0},longitude:{type:"string",required:!0},latitude:{type:"string",required:!0}}},facultiesList:{type:"object",properties:{org_id:{type:"string",required:!0}}},facultySave:{type:"object",properties:{id_faculty:{type:"number"},s_faculty:{type:"string",required:!0},faculty_ky:{type:"string",required:!0},faculty_ru:{type:"string",required:!0},faculty_en:{type:"string",required:!0},id_org:{type:"number",required:!0}}},facultyDelete:{type:"object",properties:{id_faculty:{type:"string",required:!0}}},directionsList:{type:"object",properties:{faculty_id:{type:"string",required:!0}}},directionSave:{type:"object",properties:{id_direction:{type:"number"},faculty_id:{type:"number",required:!0},direction_cipher:{type:"string",required:!0},direction_ky:{type:"string",required:!0},direction_ru:{type:"string",required:!0},direction_en:{type:"string",required:!0}}},directionDelete:{type:"object",properties:{id_direction:{type:"string",required:!0}}},specialtiesList:{type:"object",properties:{id_direction:{type:"string",required:!0}}},specialtySave:{type:"object",properties:{id_specialty:{type:"number"},specialty_cipher:{type:"string",required:!0},specialty_ky:{type:"string",required:!0},specialty_ru:{type:"string",required:!0},specialty_en:{type:"string",required:!0},id_learning:{type:"number",required:!0},id_industry:{type:"number",required:!0},id_qualification:{type:"number",required:!0},id_direction:{type:"number",required:!0},id_education_period_year:{type:"number",required:!0},id_education_period_month:{type:"number",required:!0}}},specialtyDelete:{type:"object",properties:{id_specialty:{type:"string",required:!0}}},plansList:{type:"object",properties:{years_id:{type:"string",required:!0},specialty_id:{type:"string",required:!0},id_education_level:{type:"string",required:!0},id_org:{type:"string"}}},employeeSave:{type:"object",properties:{id_users:{type:"number"},id_org:{type:"number"},surname:{type:"string",required:!0},name:{type:"string",required:!0},patronymic:{type:"string",required:!0},birth_date:{type:"string",required:!0},pin:{type:"number",required:!0},active:{type:"boolean"},okpo:{type:"string"},email:{type:"string",required:!0},telephone:{type:"number",required:!0}}}}},9345:(e,r,t)=>{const i=t(6427),n=t(3148);e.exports={organizationInfo:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_organization(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error fetching organization info: ${e.message}`),!1}},organizationInfoUpdate:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_organization_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error updating organization info: ${e.message}`),!1}},facultiesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_faculty(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculties list: ${e.message}`),!1}},facultySave:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_faculty_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty save (add or update): ${e.message}`),!1}},facultyDelete:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_faculty_del(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty delete: ${e.message}`),!1}},directionsList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_direction(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculties directions list: ${e.message}`),!1}},directionSave:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_direction_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty directions save (add or update): ${e.message}`),!1}},directionDelete:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_direction_del(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty directions delete: ${e.message}`),!1}},specialtyList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_specialty(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get specialty list by direction: ${e.message}`),!1}},specialtySave:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_specialty_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty specialty save (add or update): ${e.message}`),!1}},specialtyDelete:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_specialty_del(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization faculty specialty delete: ${e.message}`),!1}},plansList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_org_educational_plan(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get education plan list: ${e.message}`),!1}},employeesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization's employees list: ${e.message}`),!1}},employeeSave:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error save organization employee: ${e.message}`),!1}},employeeDelete:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee_del(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error delete organization employee: ${e.message}`),!1}},employeeFacultiesList:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee_faculty_grid(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error get organization's employees faculties list: ${e.message}`),!1}},employeeFacultySave:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee_faculty_save(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error save organization's employees faculty: ${e.message}`),!1}},employeeFacultyDelete:async function(e){try{const{rows:r}=await i.query(`SELECT * FROM fn_users_employee_faculty_del(${Object.keys(e).map(((e,r)=>`$${r+1}`)).join(", ")})`,Object.values(e));return r}catch(e){return n.error(`Error delete organization's employees faculty: ${e.message}`),!1}}}},94:(e,r,t)=>{const i=t(5078);e.exports=i},331:(e,r,t)=>{const i=t(3148),{send:n,sendError:s,sendSuccess:o}=t(5096),a=t(3611),c=t(7544),u=t(7782),d=t(5816),l="true"===c.CHECK_TUNDUK;e.exports=new class{async checkAccelerator(e,r){if(!a(e.body,u.checkAcceleratorSchema))return n(r,{status:"error",message:e.t("inValidFormat")},e.t("inValidFormat"),!0,400);const{pin:t,email:i}=e.body,s=await d.checkAccelerator(t,i);return 1===s?.id?o(r,s,e.t("error"),!0,200):o(r,!0,e.t("success"))}async accelerator(e,r){try{if(!a(e.body,u.acceleratorSchema))return s(r,e.t("inValidFormat"));const{body:t}=e,{pin:n,surname:c,name:p,patronymic:y,birthDate:g,idPassportSeries:m,passportNumber:f,telephone:_,email:h,password:E,idDistrict:w,address:S,idOperatingMode:O,idWorkingDay:L,kyrgyz:b,russian:q,uzbek:I,anotherLanguage:v,organizationName:x,idOwnership:A}=t,$=Number(n),T=await d.isPinEmailExist($,h);if(T.pin&&!T.email)return s(r,e.t("registry.pinExist"));if(!T.pin&&T.email)return s(r,e.t("registry.emailExist"));let k=p,C=c,R=y||"",D=g,P=`0${String(_).slice(3,12)}`;if($&&l){const t=await d.dataByPin($),{data:n,error:o}=await d.fetchData(t);if(o)return s(r,e.t("registry.pinOrPassportInCorrect"));if(n.name.toLowerCase()!=p.toLowerCase().trim())return s(r,e.t("registry.nameInCorrect"));if(n.surname.toLowerCase()!=c.toLowerCase().trim())return s(r,e.t("registry.surnameInCorrect"));if(n.dateOfBirth!=g)return s(r,e.t("registry.dateBirthInCorrect"));k=n.name,C=n.surname,R=n.patronymic,D=n.dateOfBirth,i.info(`XML ${n.pin}`)}const z=d.md5(E),j=d.insertAccelerator($,C,k,R,D,m,f,P,h,z,w,S,O,L,b,q,I,v,x,A);return j?o(r,!0,e.t("registry.success")):s(r,0==j?e.t("registry.dbInsertChallengerError"):e.t("registry.unknownError"))}catch(t){return i.error(`Error registry user ${JSON.stringify(t)}`),s(r,e.t("registry.tryError"))}}}},5078:(e,r,t)=>{const i=t(6860).Router(),n=t(331);i.post("/check",n.checkAccelerator),i.post("/accelerator",n.accelerator),e.exports=i},7782:e=>{e.exports={checkAcceleratorSchema:{type:"object",properties:{pin:{type:"number",required:!0},email:{type:"string",minLength:1,required:!0}}},acceleratorSchema:{type:"object",properties:{pin:{type:"number",required:!0},surname:{type:"string",minLength:1,required:!0},name:{type:"string",minLength:1,required:!0},patronymic:{type:"string"},birthDate:{type:"string",minLength:10,maxLength:10,required:!0},idPassportSeries:{type:"number",required:!0},passportNumber:{type:"string",required:!0},telephone:{type:"string",minLength:1,required:!0},email:{type:"string",minLength:1,required:!0},password:{type:"string",minLength:1,required:!0},idDistrict:{type:"number",required:!0},address:{type:"string",minLength:1,required:!0},idOperatingMode:{type:"number",required:!0},idWorkingDay:{type:"number",required:!0},kyrgyz:{type:"boolean",minLength:1,required:!0},russian:{type:"boolean",minLength:1,required:!0},uzbek:{type:"boolean",minLength:1,required:!0},anotherLanguage:{type:"boolean",minLength:1,required:!0},organizationName:{type:"string",minLength:1,required:!0},idOwnership:{type:"number",required:!0}}}}},5816:(e,r,t)=>{const i=t(2167),n=t(855),s=t(3148),o=t(6427),{md5:a}=t(2830);e.exports={dataByPin:async function(e){return`<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"  \n  xmlns:xro="http://x-road.eu/xsd/xroad.xsd"  \n  xmlns:iden="http://x-road.eu/xsd/identifiers"  \n  xmlns:zags="http://tunduk-seccurity-infocom.x-road.fi/producer">  \n  <soapenv:Header>  \n  <xro:userId>1</xro:userId>  \n  <xro:service iden:objectType="SERVICE">  \n  <iden:xRoadInstance>central-server</iden:xRoadInstance>  \n  <iden:memberClass>GOV</iden:memberClass>  \n  <iden:memberCode>70000005</iden:memberCode>  \n  \x3c!--Optional:--\x3e  \n  <iden:subsystemCode>zags-service</iden:subsystemCode>  \n  <iden:serviceCode>zagsDataByPin</iden:serviceCode>  \n  <iden:serviceVersion>v1</iden:serviceVersion>  \n  </xro:service>  \n  <xro:protocolVersion>4.0</xro:protocolVersion>  \n  <xro:issue>123</xro:issue>  \n  <xro:id>1</xro:id>  \n  <xro:client iden:objectType="SUBSYSTEM">  \n  <iden:xRoadInstance>central-server</iden:xRoadInstance>  \n  <iden:memberClass>GOV</iden:memberClass>  \n  <iden:memberCode>70000016</iden:memberCode>  \n  \x3c!--Optional:--\x3e  \n  <iden:subsystemCode>umut</iden:subsystemCode>  \n  </xro:client>  \n  </soapenv:Header>  \n  <soapenv:Body>  \n  <zags:zagsDataByPin>  \n  <request>  \n  <pin>${e}</pin>  \n  </request>  \n  </zags:zagsDataByPin>  \n  </soapenv:Body>  \n  </soapenv:Envelope>`},fetchData:async function(e){try{const r=await i.post("http://192.168.100.243",e,{timeout:3e4,headers:{"Content-Type":"text/xml"}}),t=(await async function(e){const r=new n.Parser;return await new Promise(((t,i)=>r.parseString(e,((e,r)=>{e?i(e):t(r)}))))}(r.data))["SOAP-ENV:Envelope"]["SOAP-ENV:Body"][0]["ts1:zagsDataByPinResponse"][0]["ts1:response"][0];return t.faultcode?{data:!1,error:"404"}:t["ts1:pin"]?{data:{pin:t["ts1:pin"][0],name:t["ts1:name"][0],surname:t["ts1:surname"][0],patronymic:t["ts1:patronymic"][0],gender:t["ts1:gender"][0],nationality:t["ts1:nationality"][0],nationalityId:t["ts1:nationalityId"][0],citizenship:t["ts1:citizenship"][0],citizenshipId:t["ts1:citizenshipId"][0],dateOfBirth:t["ts1:dateOfBirth"][0].slice(0,10)},error:!1}:{data:!1,error:"400"}}catch(e){return s.error(`zags fetchData error ${e.message}`),{data:!1,error:e.message}}},isPinEmailExist:async function(e,r){try{const{rows:t}=await o.query('select * from "fn_registration_check"($1, $2)',[e,r]);return 1===t?.[0]?.id&&"pin"===t?.[0]?.sms?{pin:!0,email:!1}:1===t?.[0]?.id&&"email"===t?.[0]?.sms?{pin:!1,email:!0}:{pin:!1,email:!1}}catch(e){return s.error(`error isPinEmailExist ${e.message}`),!1}},checkAccelerator:async function(e,r){try{const{rows:t}=await o.query('select * from "fn_registration_check"($1,$2)',[e,r]);return t[0]}catch(e){return s.error(`error checkAccelerator ${e.message}`),!1}},insertAccelerator:async function(e,r,t,i,n,a,c,u,d,l,p,y,g,m,f,_,h,E,w,S){try{const{row:s}=await o.query('select * from "fn_registration_ins"($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20);',[e,r,t,i,n,a,c,u,d,l,p,y,g,m,f,_,h,E,w,S]);return 1===s?.[0]?.id}catch(e){return s.error(`error insertAccelerator ${e.message}`),!1}},md5:a}},2919:(e,r,t)=>{const i=t(3148);e.exports={getLangId:async function(e){try{let r=1;switch(e){case"ru":default:r=1;break;case"ky":r=2;break;case"en":r=3}return r}catch(e){return i.error(`error getLangId ${e.message}`),1}},langIdNext:async function(e,r,t){try{const r=e.i18n.resolvedLanguage;let i=1;switch(r){case"ru":default:i=1;break;case"ky":i=2;break;case"en":i=3}e.langId=i,t()}catch(r){e.langId=1,t()}}}},7177:(e,r,t)=>{const i=t(6427),{md5:n}=t(2830),s=t(7544),o=t(3148),a=t(2751);e.exports={getUser:async function(e){try{if("development"===s.NODE_ENV&&"true"===s.FAKE_AUTH_MODE){return{id:parseInt(s.FAKE_ID)||12,staff:"true"===s.FAKE_IS_STAFF}}const{rowCount:r,rows:t}=await i.query('SELECT * FROM "fn_Session_Get_User"($1)',[n(String(e))]);return!!r&&{...t[0]}}catch(e){return o.error(`error getUser ${e.message}`),!1}},getTokenUser:async function(e){try{if(e){const r=a.getTokenData(e);if(e&&r&&r.exp>new Date)return r}return!1}catch(e){return o.error(`getTokenData error catch => ${JSON.stringify(e)}`),!1}}}},6184:(e,r,t)=>{const i=t(6426);e.exports=i},76:(e,r,t)=>{const{send:i,sendError:n,sendSuccess:s}=t(5096),o=t(3611),a=t(8083),c=t(6282),u=t(2919),d=t(7177),l=t(2830),{decrypt:p}=(t(5681),t(7544),t(5325));e.exports=new class{async region(e,r){const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),o=await c.region(i);return o?s(r,o,e.t("success")):n(r,e.t("error"))}async district(e,r){if(!o(e.query,a.districtSchema))return i(r,{status:"error",message:e.t("inValidFormat")},e.t("inValidFormat"),!0,400);const t=e.i18n.resolvedLanguage,d=await u.getLangId(t),{region:l}=e.query,p=await c.district(d,parseInt(l));return p?s(r,p,e.t("success")):n(r,e.t("error"))}async districtByDistrict(e,r){if(!o(e.query,a.districtByDistrictSchema))return i(r,{status:"error",message:e.t("inValidFormat")},e.t("inValidFormat"),!0,400);const t=e.i18n.resolvedLanguage,d=await u.getLangId(t),{district:l}=e.query,p=await c.districtByDistrict(d,parseInt(l));return p?s(r,p,e.t("success")):n(r,e.t("error"))}async direction(e,r){if(!o(e.query,a.directionSchema))return i(r,{status:"error",message:e.t("inValidFormat")},e.t("inValidFormat"),!0,400);const t=e.i18n.resolvedLanguage,d=await u.getLangId(t),{education:l}=e.query,p=await c.direction(d,parseInt(l));return p?s(r,p,e.t("success")):n(r,e.t("error"))}async settings(e,r){const t=await c.settings();return t?s(r,t,e.t("success")):n(r,e.t("error"))}async passwordChange(e,r){if(!o(e.body,a.passwordChangeSchema))return n(r,e.t("inValidFormat"));const{oldPassword:t,newPassword:i}=e.body,u=e.headers.authorization,p=(await d.getTokenUser(u)).id;if(await c.getOldPassword(p)!=l.md5(t))return n(r,e.t("oldPasswordError"));const y=l.md5(i),g=await c.updatePassword(p,y);return g?s(r,g,e.t("success")):n(r,e.t("error"))}async yearsList(e,r){if(!o(e.body,a.yearsSchema))return n(r,"Invalid format");const t=await c.yearsList();return t?s(r,t,"Success"):n(r,"Error")}async gendersList(e,r){if(!o(e.body,a.genderSchema))return n(r,"Invalid format");const t=await c.gendersList();return t?s(r,t,"Success"):n(r,"Error")}async learningList(e,r){const t=await c.learningList();return t?s(r,t,"Learning types list returned successfully."):n(r,"An error occurred while get learning types.")}async qualificationsList(e,r){const t=e.i18n.resolvedLanguage,i=await u.getLangId(t),o=e.query?.id_org_type,a=e.user?.orgTypeId;if(!o&&!a)return n(r,"Org type not found");const d=await c.qualificationsList({language:i,id_org_type:o||a});return d?s(r,d,"Qualification list list returned successfully."):n(r,"An error occurred while get qualification list.")}async disciplinesLabelList(e,r){const t=await c.disciplinesLabelList();return t?s(r,t,"Success"):n(r,"Error")}}},6426:(e,r,t)=>{const i=t(6860).Router(),n=t(76),s=t(2986);i.get("/region",n.region),i.get("/district",n.district),i.get("/districtByDistrict",n.districtByDistrict),i.get("/direction",n.direction),i.get("/settings",s.isAuth,n.settings),i.get("/years-list",n.yearsList),i.get("/genders-list",n.gendersList),i.get("/learning-list",n.learningList),i.get("/qualifications-list",n.qualificationsList),i.get("/disciplines-list",n.disciplinesLabelList),i.post("/password/change",s.isAuth,n.passwordChange),e.exports=i},8083:e=>{e.exports={districtSchema:{type:"object",properties:{region:{type:"string",required:!0}}},directionSchema:{type:"object",properties:{education:{type:"string",required:!0}}},passwordChangeSchema:{type:"object",properties:{oldPassword:{type:"string",required:!0,minLength:8,maxLength:28},newPassword:{type:"string",required:!0,minLength:8,maxLength:28}}},districtByDistrictSchema:{type:"object",properties:{district:{type:"string",required:!0}}},yearsSchema:{type:"object",properties:{}},genderSchema:{type:"object",properties:{}},qualificationsSchema:{type:"object",properties:{id_org_type:{type:"string",required:!0}}}}},6282:(e,r,t)=>{const{MANUAL_VIDEO:i,MANUAL_PDF:n,MANUAL_VIDEO_PATH:s,MANUAL_PDF_PATH:o}=t(7544),a=t(6427),c=t(3148);e.exports={region:async function(e){try{const{rows:r}=await a.query('SELECT * FROM "fn_region"($1)',[e]);return r}catch(e){return c.error(`Error region: ${e.message}`),!1}},district:async function(e,r){try{const{rows:t}=await a.query('SELECT * FROM "fn_district"($1, $2)',[e,r]);return t}catch(e){return c.error(`Error region: ${e.message}`),!1}},direction:async function(e,r){try{const{rows:t}=await a.query('SELECT * FROM "fn_education_level_direction"($1, $2)',[e,r]);return t}catch(e){return c.error(`Error direction: ${e.message}`),!1}},updatePassword:async function(e,r){try{const{rowCount:t}=await a.query("UPDATE public.users\n    SET  password=$2 WHERE id_users=$1;",[e,r]);return t}catch(e){return c.error(`Error settings updatePassword: ${e.message}`),!1}},getOldPassword:async function(e){try{const{rowCount:r,rows:t}=await a.query('SELECT "password" FROM public.users\n    WHERE id_users = ($1);',[e]);return!!r&&t[0].password}catch(e){return c.error(`Error settings getOldPassword: ${e.message}`),!1}},districtByDistrict:async function(e,r){try{const{rows:t}=await a.query("SELECT\n\t\t    district.id_district, lan_district($1, district.id_district) as district\n\t    FROM district\n      WHERE district.id_region = (select id_region from district d where id_district=$2)\n\t    ORDER BY district;",[e,r]);return t}catch(e){return c.error(`Error districtByDistrict: ${e.message}`),!1}},settings:async function(){try{const{rows:e}=await a.query("SELECT s.settings_name, s.settings_value FROM public.settings s\n    WHERE s.public = true",[]);return e}catch(e){return c.error(`Error settings: ${e.message}`),!1}},yearsList:async function(){try{const{rows:e}=await a.query("SELECT * FROM fn_years();");return e}catch(e){return c.error(`Error fetching years:: ${e.message}`),!1}},classesList:async function(){try{const{rows:e}=await a.query("SELECT * FROM fn_class();");return e}catch(e){return c.error(`Error fetching classes:: ${e.message}`),!1}},gendersList:async function(){try{const{rows:e}=await a.query("SELECT * FROM fn_gender()");return e}catch(e){return c.error(`Error fetching genders:: ${e.message}`),!1}},learningList:async function(){try{const{rows:e}=await a.query("SELECT * FROM fn_learning()",[]);return e}catch(e){return c.error(`Error fetching learning list: ${e.message}`),!1}},qualificationsList:async function({language:e,id_org_type:r}){try{const{rows:t}=await a.query("SELECT * FROM fn_qualification($1, $2)",[e,parseInt(r)]);return t}catch(e){return c.error(`Error fetching qualifications list:: ${e.message}`),!1}},disciplinesLabelList:async function(){try{const{rows:e}=await a.query("SELECT * FROM fn_discipline_dop_name()");return e}catch(e){return c.error(`Error fetching disciplines labels:: ${e.message}`),!1}}}},7934:e=>{e.exports={passwordMessage:e=>`<header>\n            \t<h1>Реестр дипломов | Диплом</h1>\n                <p>ИС: <a target="_blank" href="https://diplom.edu.gov.kg/diplom/login">https://diplom.edu.gov.kg/diplom/login</a></p>\n\t\t\t\t<p class="auth">\n                  <span><b>Логин:</b> ИЖН (ПИН)</span><br>\n                  <span><b>Пароль:</b> ${e}</span>\n                </p>\n            \t<h2>Внимание:</h2>\n            \t<p>Не делитесь своим паролем ни с кем.</p>\n            </header>`}},6340:(e,r,t)=>{const i=t(6537);e.exports=i},1480:(e,r,t)=>{const{send:i,sendError:n,sendSuccess:s}=t(5096),o=t(3611),a=(t(8308),t(2830),t(2751)),c=t(5817),u=t(2919),d=t(7092),l=t(7544);t(3148),e.exports=new class{async login(e,r){if(!o(e.body,c.userSchema))return n(r,e.t("inValidFormat"));const t=e.i18n.resolvedLanguage,s=await u.getLangId(t),{login:p,password:y}=e.body,g=await d.login(s,String(p),y);if(g){const e=Date.now()+60*parseInt(l.JWT_EXPIRE_HOURS)*60*1e3,t=a.generateAccessToken({id:g.idUser,org:g.idOrganization,role:[g.role],type:g.idRole,pin:g.pin,s:g.surname,n:g.name,p:g.patronymic,okpo:g.okpo,orgTypeId:g.orgTypeId,exp:e});if(!t)return n(r,"tokenGenerateError");if(g)return i(r,{authState:{id:g.idUser,org:g.idOrganization,role:[g.role],type:g.idRole,pin:g.pin,s:g.surname,n:g.name,p:g.patronymic,okpo:g.okpo,orgTypeId:g.orgTypeId,exp:e},token:t,tokenType:"Bearer",expiresIn:60*parseInt(l.JWT_EXPIRE_HOURS)},"success",!1,200)}return n(r,e.t("unauth"),401)}async check(e,r){const t=e.headers.authorization;if(!t)return n(r,"noToken",401);const s=a.getTokenData(t),o=String(t).split(" ")[1];return s&&s.exp>new Date?i(r,{authState:{id:s.id,org:s.org,role:s.role,type:s.type,pin:s.pin,s:s.s,n:s.n,p:s.p,okpo:s.okpo,orgTypeId:s.orgTypeId,exp:s.exp},token:o,tokenType:"Bearer",expiresIn:parseInt((s.exp-Date.now())/6e4)},"success",!1,200):n(r,"error",401)}async logout(e,r){return s(r,!0,e.t("success"))}}},6537:(e,r,t)=>{const i=t(6860).Router(),n=t(1480);i.post("/login",n.login),i.post("/check",n.check),i.post("/logout",n.logout),e.exports=i},5817:e=>{e.exports={userSchema:{type:"object",properties:{login:{type:["string","number"],required:!0},password:{type:"string",required:!0}}},externalUserSchema:{type:"object",properties:{token:{type:"string",required:!0}}}}},7092:(e,r,t)=>{const i=t(6427),{md5:n}=t(2830),s=t(7544);e.exports={getUser:async function(e){try{if("development"===s.NODE_ENV&&"true"===s.FAKE_AUTH_MODE){return{id:parseInt(s.FAKE_ID)||12,staff:"true"===s.FAKE_IS_STAFF}}const{rowCount:r,rows:t}=await i.query('SELECT * FROM "fn_Session_Get_User"($1)',[n(String(e))]);return!!r&&{...t[0]}}catch(e){return console.error("Error in getUser:",e.message),!1}},login:async function(e,r,t){try{const s=n(t),{rows:o}=await i.query("select * from fn_auth($1, $2, $3);",[e,r,s]);if(o.length>0){const{id:e,id_role:r,id_organization:t,pin:i,role:n,surname:s,name:a,patronymic:c,okpo:u,id_org_type:d}=o[0];return{idUser:e,idRole:r,idOrganization:t,pin:i,role:n,surname:s,name:a,patronymic:c,okpo:u,orgTypeId:d}}return!1}catch(e){return console.error("Error in login:",e.message),!1}},getUserByPin:async function(e){try{const{rows:r}=await i.query("select u.*, role.role from users u where pin=$1 inner join role using ($1)",[e]);if(r.length>0){const{id_users:e,id_role:t,id_organization:i,role:n,surname:s,name:o,patronymic:a,okpo:c,pin:u}=r[0];return{idUser:e,idRole:t,role:n,idOrganization:i,pin:u,surname:s,name:o,patronymic:a,okpo:c,pin:u}}return!1}catch(e){return console.error("Error in getUserByPin:",e.message),!1}},getRoleByRoleId:async function(e){try{const{rows:r}=await i.query("select * from role r where id_role=$1",[e]);return r.length>0&&r[0]}catch(e){return console.error("Error in getRoleByRoleId:",e.message),!1}},getOrganizationByOrganizationId:async function(e){try{const{rows:r}=await i.query("select * from organization where id_organization=$1",[e]);return r.length>0&&r[0]}catch(e){return console.error("Error in getOrganization by organization id:",e.message),!1}},insertUser:async function(e){try{if(!e.data.pin)return!1;const{pin:r,first_name:t,last_name:n,middle_name:s,okpo:o,id_organization:a,role:c}=e,{rows:u,rowCount:d}=await i.query(`INSERT INTO users (id_role, surname, name, patronymic, pin, okpo, id_organization) \n     VALUES (3, '${n}', '${t}', '${s}', '${r}','${o}', ${a}) RETURNING * `,[]);if(d>0){const{id_users:e,id_role:t,id_organization:i,surname:n,name:s,patronymic:o,email:a,okpo:d}=u[0];return{idUser:e,idRole:t,idOrganization:i,pin:r,role:c,surname:n,name:s,patronymic:o,email:a,okpo:d}}}catch(e){return console.error("Error in insertUser:",e.message),!1}},getUserById:async function(e){try{const{rows:r}=await i.query("SELECT x.* FROM public.users x where x.id_users=$1",[e]);return r[0]}catch(e){return console.error("Error in getUserByPin:",e.message),!1}},getOrganizationByOKPO:async function(e){try{const{rows:r}=await i.query("select id_organization from organization where okpo=$1",[e]);return r.length>0&&r[0].id_organization}catch(e){return console.error("Error in getOrganizationByOKPO:",e.message),!1}}}},7544:(e,r,t)=>{t(5142).config();const i=t(3148),n=process.env.APP_URL||"accelerator",s=process.env.ORG_PATH||"C:\\",o=process.env.DOC_PATH||"C:\\",a=process.env.JWT_ACCESS_SECRET||"5c543f356c79a4717708dfdde1a872c9bc6a4369d2b419bc0a8c234ea9795df71727a375bea260aede25f87fa5d504c029eb7f9513f2792eea169cc5cf2d0db2",c=process.env.JWT_EXTERNAL_ACCESS_SECRET,u=process.env.JWT_EXPIRE_HOURS||"30h";i.debug({JWT_ACCESS_SECRET:a});const d=process.env.COOKIE_NAME||"tokenDiploma",l=process.env.COOKIE_PATH||"/diploma/api",p=process.env.MAX_AGE||"6000000",y=process.env.ALLOW_HOST||"http://mon.sc.on.kg",g=["https://diplom.edu.gov.kg","https://dev2.edu.gov.kg",y],m=process.env.DBUSER||"DBUSER",f=process.env.DBPASS||"DBPASS",_=process.env.DBSERVER||"DBSERVER",h=process.env.DBPORT||"5432",E=process.env.DBNAME||"diplom",w=process.env.DBPG_MAX_CONNECTIONS||20,S=process.env.DBPG_IDLETIMEOUTMILLLIS||3e4,O=process.env.DBPG_CONNECTIONTIMEOUTMILLES||2e3,L=process.env.EMAIL_API||"",b=process.env.EMAIL_TYPE||"",q=process.env.DEBUG_MODE||"false",I=process.env.FAKE_AUTH_MODE||"false",v=process.env.FAKE_IS_STAFF||"false",x=process.env.FAKE_ID||11,A=process.env.PORT||"3000",$=process.env.CHECK_TUNDUK||"false",T=process.env.SECURITY_SERVER_URL||"http://192.168.100.243",k=process.env.PIN_CONSUMER||"umut",C=process.env.REGISTER_ALLOW||"false",R=process.env.GRADUATES_DOCS_FOLDER||"/media/docs/graduates";e.exports={REGISTER_ALLOW:C,JWT_ACCESS_SECRET:a,JWT_EXTERNAL_ACCESS_SECRET:c,JWT_EXPIRE_HOURS:u,COOKIE_PATH:l,MAX_AGE:p,ALLOW_HOST:y,ALLOW_HOST_LIST:g,COOKIE_NAME:d,DBUSER:m,DBPASS:f,DBSERVER:_,DBNAME:E,DBPORT:h,DBPG_MAX_CONNECTIONS:w,DBPG_IDLETIMEOUTMILLLIS:S,DBPG_CONNECTIONTIMEOUTMILLES:O,EMAIL_API:L,EMAIL_TYPE:b,PORT:A,NODE_ENV:"production",DEBUG_MODE:q,FAKE_AUTH_MODE:I,FAKE_IS_STAFF:v,FAKE_ID:x,APP_URL:n,ORG_PATH:s,DOC_PATH:o,CHECK_TUNDUK:$,SECURITY_SERVER_URL:T,PIN_CONSUMER:k,GRADUATES_DOCS_FOLDER:R}},8308:(e,r,t)=>{const{v4:i}=t(5828),{md5:n}=t(2830),s=t(6427),o=t(7544),a=o.COOKIE_NAME,c=o.COOKIE_MOBILE;async function u(e){if("development"===o.NODE_ENV&&"true"===o.FAKE_MODE)return{role:o.FAKE_ID_ROLE,id:o.FAKE_ID_USER};if(e&&e.headers.authorization){const r=e.headers.authorization,{rowCount:t,rows:i}=await s.query('SELECT * FROM "fn_Session_Get_User"($1)',[n(String(r))]);if(t)return{...i[0]}}return!1}async function d(e,r,t,i,n){const{rowCount:o}=await s.query('\n        INSERT INTO "Session_log" (login, id_user,id_role, log_time, is_mobile, ip)\n        VALUES ($1, $2, $3, current_timestamp, $4, $5)',[e,r,t,i,n]);return!!o}parseInt(o.MAX_AGE),e.exports.LOGIN=async function(e,r,t,o,a,u=!1){const l="true"==String(e.cookies[c]),p=u||await async function(e){return i()}(),y=n(p),g=e.headers["x-forwarded-for"]?e.headers["x-forwarded-for"].split(",").shift():e.ip,{rows:m}=await s.query('SELECT  EXISTS( select 1 FROM "Session" where login =$1)',[String(t)]);if(m[0].exists){const{rowCount:e}=await s.query('UPDATE "Session" \n                                             SET offline=false, \n                                                 last_action=current_timestamp, \n                                                 cookie=$2, \n                                                 id_user=$3, \n                                                 is_mobile=$4,\n                                                 id_role=$5\n                                             WHERE login=$1',[String(t),y,o,l,a]);return e&&await d(String(t),o,a,l,g),p}{const{rowCount:e}=await s.query('\n            INSERT INTO "Session" (cookie, login, id_user, id_role, last_action, is_mobile)\n            VALUES ($1, $2, $3, $4, current_timestamp, $5)',[y,t,o,a,l]);return e&&await d(String(t),o,a,l,g),p}},e.exports.LOGOUT=async function(e,r){const t=n(String(e.headers.authorization)),{command:i,rowCount:o}=await s.query('UPDATE "Session" SET offline=true\n                                                WHERE offline=false AND login IN\n                                                (SELECT login FROM "Session" \n                                                WHERE cookie=$1)',[t]);return"UPDATE"==i&&{rowCount:o}},e.exports.CHECK_PERM=async function(e){const r=await u(e);return e.user=r,!!r},e.exports.GET_USER=u,e.exports.COOKIE_NAME=a},208:(e,r,t)=>{const{ALLOW_HOST_LIST:i}=t(7544);e.exports={corsOptionsDelegate:(e,r)=>{var t;r(null,(t=e.headers.origin)?i.includes(t)?{origin:!0,credentials:!0}:{origin:!1}:(console.warn("Origin header not found in request. Access may be restricted."),{origin:i.length>0?i[0]:"*"}))}}},5325:(e,r,t)=>{const i=t(6113),n=Buffer.from("3e10bb241d611ac910af5d8690011e6c","hex"),s=Buffer.from("34db16c275e2895654e798794f6e47ae","hex"),o="aes-128-cbc";e.exports={encrypt:function(e){let r=i.createCipheriv(o,s,n),t=r.update(e,"utf8","base64");return t+=r.final("base64"),t},decrypt:function(e){let r=i.createDecipheriv(o,s,n),t=r.update(e,"base64","utf8");return t+=r.final("utf8"),t}}},6427:(e,r,t)=>{const{Pool:i}=t(5900),n=t(9427),s=t(7544),o=t(3148),a=new i({host:s.DBSERVER,port:s.DBPORT,database:s.DBNAME,user:s.DBUSER,password:s.DBPASS,max:parseInt(s.DBPG_MAX_CONNECTIONS),idleTimeoutMillis:parseInt(s.DBPG_IDLETIMEOUTMILLLIS),connectionTimeoutMillis:parseInt(s.DBPG_CONNECTIONTIMEOUTMILLES)});!async function(){try{return a.query("select 1 as answer",[]).then((e=>{o.info(`Connected to PG => ${e.rows[0]&&1==e.rows[0].answer}`)})).catch((e=>{throw o.error(`Error executing query ${JSON.stringify(e.stack)}`),n.Sentry.captureException(e),new Error(e)}))}catch(e){return o.error("PG ERROR => "),console.log(e),{rows:[],rowCount:0,error:e.message}}}(),e.exports={query:(e,r)=>async function(e,r){try{const t=await a.query(e,r);return{rows:t.rows,rowCount:t.rowCount,error:!1}}catch(t){return o.error("PG ERROR => "),console.log(t),o.debug(`PG query: \n  Query: ${e} \n  Params: `),console.log(r),n.Sentry.captureException(t),{rows:[],rowCount:0,error:t.message}}}(e,r),callback:(e,r,t)=>a.query(e,r,t)}},4972:(e,r,t)=>{const i=t(7544),n=t(3148),s=i.EMAIL_API,o=i.EMAIL_TYPE;e.exports={sendMessage:async function(e){const{email:r="",message:t="",content:i="",redirect:a=!1}=e;try{const e=await fetch(`${s}/mail/send`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({message:t,type:o,email:r.trim(),redirect:a,content:i})});return n.info("Response send message:"),console.log(e),e}catch(e){return n.error(`Error send message: ${e.message}`),console.log(e),null}}}},548:(e,r,t)=>{const i=t(7641),n=(t(1017),t(3148));e.exports={createExcel:async function(e,r,t,s){if(!e||!r)return void s.status(400).send("Bad Request: Data and columns are required.");const o=new i.Workbook,a=o.addWorksheet("Sheet1"),c={font:{bold:!0},alignment:{horizontal:"center"}};a.columns=r.map((e=>({...e,style:{...e.style,alignment:{horizontal:e.horizontal??"left"},width:e.width||15}}))),a.getRow(1).eachCell({includeEmpty:!0},(e=>{e.style=c})),e.forEach((e=>{a.addRow(e)})),a.columns.forEach((function(e,r){let t=e.width??15;e.eachCell({includeEmpty:!0},(function(e){let r=e.value?e.value.toString().length:10;r>t&&(t=r)})),e.width=t<10?10:t})),s.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),s.setHeader("Content-Disposition",`attachment; filename="${t}.xlsx"`);try{await o.xlsx.write(s),n.info("Excel file successfully sent"),s.end()}catch(e){console.error("Error:",e),s.status(500).send("Internal Server Error")}}}},5681:(e,r,t)=>{const i=t(7147);e.exports={exists:async e=>!!await i.promises.stat(e).catch((e=>("true"===process.env.DEBUG_MODE&&console.debug(e),!1))),deleteFile:async e=>await i.promises.unlink(e).catch((e=>("true"===process.env.DEBUG_MODE&&console.debug(e),!1))),listDir:async e=>await i.promises.readdir(e).catch((e=>("true"===process.env.DEBUG_MODE&&console.debug(e),[]))),write:async(e,r)=>await i.promises.writeFile(e,r,"utf8"),read:async e=>await i.promises.readFile(e,"utf8")}},9800:(e,r,t)=>{t(7806);const{ALLOW_HOST_LIST:i}=t(7544);e.exports={helmetConfig:()=>({contentSecurityPolicy:{directives:{defaultSrc:["'self'","unsafe-inline","https://cdnjs.cloudflare.com",...i],scriptSrc:["'self'","unsafe-inline","https://cdnjs.cloudflare.com",...i],imgSrc:["'self'","unsafe-inline","data:image/*",...i],connectSrc:["'self'","unsafe-inline",...i],fontSrc:["'self'","unsafe-inline","https://fonts.gstatic.com",...i]}},crossOriginEmbedderPolicy:{policy:"require-corp"},crossOriginResourceSharing:{origin:i,credentials:!0},hsts:{maxAge:31536e3,includeSubdomains:!0,preload:!0},referrerPolicy:{policy:"same-origin"},frameguard:{action:"deny"},xssFilter:{enabled:!0}})}},5304:(e,r,t)=>{const i=t(8805),n=t(5763),s=t(6379),o={ru:{translation:t(1089)},ky:{translation:t(8040)},en:{translation:t(7551)}};i.use(n).use(s.LanguageDetector).init({resources:o,defaultNS:"translation",detection:{order:["querystring","cookie"],cache:["cookie"],lookupQuerystring:"lang",lookupCookie:"lang"},fallbackLng:["ru","ky","en"],preload:["ru"]});const a=s.handle(i);e.exports=a},2751:(e,r,t)=>{const i=t(9344),n=t(5325),s=t(3148),{JWT_ACCESS_SECRET:o,JWT_EXPIRE_HOURS:a,JWT_EXTERNAL_ACCESS_SECRET:c}=t(7544);e.exports={generateAccessToken:e=>i.sign({data:n.encrypt(JSON.stringify(e))},o,{expiresIn:a}),verifyAccessToken:e=>{try{const r=String(e).split(" ");if("Bearer"!=r[0]||r[1].length<20)return!1;return i.verify(r[1],o)||!1}catch(e){return s.error(JSON.stringify(e)),!1}},getTokenData:e=>{try{const r=String(e).split(" ");if("Bearer"!=r[0]||r[1].length<20)return!1;const t=i.verify(r[1],o);return!!t&&{...JSON.parse(n.decrypt(t.data))}}catch(e){return s.error(JSON.stringify(e)),!1}},generateLinkToken:(e,r=600)=>i.sign({data:e},o,{expiresIn:r||a}),getExternalTokenData:e=>{try{const r=i.verify(e,c);return!!r&&{...r}}catch(e){return s.error(JSON.stringify(e)),!1}}}},2986:(e,r,t)=>{const i=t(7544),n=t(7092),s=t(3148),{getTokenData:o}=t(2751),a={ADMIN:1,MINISTRY:2,EMPLOYEE:3,TYPOGRAPHY:4,SUPERVISOR:5,RAYONO:6,ORGANIZATION:6},c=(e,r)=>e.status(401).json({message:r,error:!0,data:!1}),u=async(e,r,t)=>{try{const a=e.headers.authorization;if(e.token=a,!a)return c(r,"Token not found");const u=o(a),d=await n.getUserById(u.id);return u.type!==d.id_role?c(r,"Returned role is not equal"):("development"===i.NODE_ENV&&s.debug({decodedData:u}),!u||u.exp<=new Date?c(r,"Token expired or invalid"):null===t||t.includes(u.type)?(e.user=u,!0):c(r,"Permission denied"))}catch(e){return s.error(`CheckUser error catch => ${e}`),c(r,"Unexpected error")}};e.exports={ROLES:a,roleGuard:e=>async(r,t,i)=>await u(r,t,e)?i():c(t,"Unexpected error"),isAuth:async(e,r,t)=>await u(e,r,null)?t():c(r,"Unexpected error"),isAdmin:async(e,r,t)=>{const i=[a.ADMIN];return await u(e,r,i)?t():c(r,"Unexpected error")},isMinistry:async(e,r,t)=>{const i=[a.MINISTRY];return await u(e,r,i)?t():c(r,"Unexpected error")},isEmployee:async(e,r,t)=>{const i=[a.EMPLOYEE,a.ORGANIZATION,a.SUPERVISOR],n=await u(e,r,i),s=e.query.okpo||e.body.okpo,o=e.user.okpo;return s&&s!=o&&e.user.type===a.EMPLOYEE||!n?c(r,"Permission denied"):t()},isSupervisor:async(e,r,t)=>{const i=[a.SUPERVISOR],n=await u(e,r,i),s=e.query.okpo||e.body.okpo,o=e.user.okpo;return s&&s!=o&&e.user.type===a.SUPERVISOR||!n?c(r,"Permission denied"):t()},isTypography:async(e,r,t)=>{const i=[a.TYPOGRAPHY];return await u(e,r,i)?t():c(r,"Unexpected error")},isRayono:async(e,r,t)=>{const i=[a.RAYONO,a.MINISTRY];return await u(e,r,i)?t():c(r,"Unexpected error")},validateToken:u}},3148:(e,r,t)=>{const{createLogger:i,format:n,transports:s,addColors:o}=t(7773),a={levels:{fatal:0,error:1,warn:2,info:3,debug:4,trace:5},colors:{fatal:"magenta",error:"red",warn:"yellow",info:"cyan",debug:"green",trace:"blue"}};o(a.colors);const c=i({levels:a.levels,format:n.combine(n.colorize(),n.simple()),transports:[new s.Console]});e.exports=c},5096:e=>{const r=(e,r=!1,t="OK",i=!1,n=200)=>e.status(n).json({data:r,message:t,error:i});e.exports={send:r,sendSuccess:(e,t=!1,i="OK")=>r(e,t,i,!1,200),sendError:(e,t="Error",i=400)=>r(e,!1,t,!0,i)}},9427:(e,r,t)=>{const i=t(9856),n=t(4842);e.exports={initSentry:function(e){i.init({dsn:"https://3a772c29b3cb48d4be55edb069b2ef19@o188902.ingest.sentry.io/4504909839400960",integrations:[new i.Integrations.Http({tracing:!0}),new n.Integrations.Express({app:e})],tracesSampleRate:.001})},Sentry:i}},7989:(e,r,t)=>{const i=t(7777),n=t(1017),s=t(4147),o=i({definition:{openapi:"3.0.0",info:{title:s.name.toUpperCase()||"diploma-back",description:s.description||"mon diploma",version:s.version||"1.0.0",contact:{name:s.author||"Unknown Author",email:s.email||"author@example.com"},license:{name:s.license||"ISC",url:"https://opensource.org/licenses/ISC"}},servers:[{url:"http://localhost:5000/diploma/api"},{url:"https://diploma.edu.gov.kg/diploma/api"}],tags:[{name:"Diploma",description:"Endpoints related to diploma data"},{name:"Shared",description:"Endpoints related to shared data"}],components:{securitySchemes:{bearerAuth:{type:"http",scheme:"bearer",bearerFormat:"JWT"}}},security:[{bearerAuth:[]}]},apis:[n.join(__dirname,"../shared/sharedRoute.js"),n.join(__dirname,"../diploma/diplomaRoute.js")]});e.exports=o},2830:(e,r,t)=>{const i=t(6113),n={Ң:"N",Ө:"O",Ү:"U",Ё:"YO",Й:"I",Ц:"TS",У:"U",К:"K",Е:"E",Н:"N",Г:"G",Ш:"SH",Щ:"SCH",З:"Z",Х:"H",Ъ:"'",ё:"yo",й:"i",ц:"ts",у:"u",к:"k",е:"e",н:"n",г:"g",ш:"sh",щ:"sch",з:"z",х:"h",ъ:"'",Ф:"F",Ы:"I",В:"V",А:"A",П:"P",Р:"R",О:"O",Л:"L",Д:"D",Ж:"ZH",Э:"E",ф:"f",ы:"i",в:"v",а:"a",п:"p",р:"r",о:"o",л:"l",д:"d",ж:"zh",э:"e",Я:"Ya",Ч:"CH",С:"S",М:"M",И:"I",Т:"T",Ь:"'",Б:"B",Ю:"YU",я:"ya",ч:"ch",с:"s",м:"m",и:"i",т:"t",ь:"'",б:"b",ю:"yu",ө:"o",ң:"n",ү:"u"};function s(e){return i.createHash("md5").update(e).digest("hex")}e.exports={salt:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},md5:e=>s(e),generatePassword:()=>function(){for(var e="",r=0;r<6;++r)e+="abcdefghijkmnpqrstuvxyzABCDEFGHJKLMNPQRSTUVXYZ23456789".charAt(Math.floor(54*Math.random()));return{crypto:s(e),password:e}}(),onlyLetterNumberDot:function(e){return String(e||"").replace(/[^a-zA-ZА-Яа-яёЁ.0-9]/gm,"")||(new Date).getTime()},onlyLetterNumberDotUnderscore:function(e){return String(e||"").replace(/[^a-zA-ZА-Яа-яёЁ._0-9]/gm,"")||(new Date).getTime()},transliterate:function(e){return e.split("").map((function(e){return n[e]||e})).join("")},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},groupBy:function(e,r){return e.reduce((function(e,t){return(e[t[r]]=e[t[r]]||[]).push(t),e}),{})}}},3611:(e,r,t)=>{const{Validator:i}=t(9832);e.exports=(e,r)=>(new i).validate(e,r).valid},9856:e=>{"use strict";e.exports=require("@sentry/node")},4842:e=>{"use strict";e.exports=require("@sentry/tracing")},2167:e=>{"use strict";e.exports=require("axios")},7455:e=>{"use strict";e.exports=require("compression")},9710:e=>{"use strict";e.exports=require("cookie-parser")},3582:e=>{"use strict";e.exports=require("cors")},5142:e=>{"use strict";e.exports=require("dotenv")},7641:e=>{"use strict";e.exports=require("exceljs")},6860:e=>{"use strict";e.exports=require("express")},6674:e=>{"use strict";e.exports=require("express-fileupload")},7806:e=>{"use strict";e.exports=require("helmet")},8805:e=>{"use strict";e.exports=require("i18next")},6379:e=>{"use strict";e.exports=require("i18next-http-middleware")},5763:e=>{"use strict";e.exports=require("i18next-node-fs-backend")},9832:e=>{"use strict";e.exports=require("jsonschema")},9344:e=>{"use strict";e.exports=require("jsonwebtoken")},5900:e=>{"use strict";e.exports=require("pg")},7777:e=>{"use strict";e.exports=require("swagger-jsdoc")},9948:e=>{"use strict";e.exports=require("swagger-ui-express")},5828:e=>{"use strict";e.exports=require("uuid")},7773:e=>{"use strict";e.exports=require("winston")},855:e=>{"use strict";e.exports=require("xml2js")},6113:e=>{"use strict";e.exports=require("crypto")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},7551:e=>{"use strict";e.exports=JSON.parse('{"error":"Ошибка","inValidFormat":"inValid format","passwordLengthError":"Пароль должен содержать минимум 8 символов"}')},8040:e=>{"use strict";e.exports=JSON.parse('{"error":"Ошибка","inValidFormat":"Туура эмес маалымат","passwordLengthError":"Пароль должен содержать минимум 8 символов","register":{"pinExist":"Пользователь с таким ПИН/ИНН уже существует!","emailExist":"Пользователь с таким e-mail уже существует!","pinOrPassportInCorrect":"ПИН указан не верно или паспортные данные неверны","nameInCorrect":"Введите ваше имя правильно!","surnameInCorrect":"Введите вашу фамилию правильно!","dateBirthInCorrect":"Введите правильный день рождения!","ageError":"Ошибка, ваш возраст должен быть от 20 до 35!","success":"Вы успешно зарегистрированы!","dbInsertChallengerError":"Ошибка, не удалось сохранить!","unknownError":"Ошибка, неизвестная!","tryError":"Ошибка, попробуйте еще раз!"}}')},1089:e=>{"use strict";e.exports=JSON.parse('{"error":"Ошибка","inValidFormat":"Неверный формат данных","oldPasswordError":"Старый пароль невеверный!","passwordLengthError":"Пароль должен содержать минимум 6 символов","register":{"pinExist":"Пользователь с таким ПИН/ИНН уже существует!","emailExist":"Пользователь с таким e-mail уже существует!","pinOrPassportInCorrect":"ПИН указан неверно или паспортные данные неверны","nameInCorrect":"Введите ваше имя правильно!","surnameInCorrect":"Введите вашу фамилию правильно!","dateBirthInCorrect":"Введите правильную дату рождения!","ageError":"Ошибка, ваш возраст должен быть от 20 до 35!","success":"Вы успешно зарегистрированы!","dbInsertChallengerError":"Ошибка, не удалось сохранить!","unknownError":"Ошибка, неизвестная!","tryError":"Ошибка, попробуйте еще раз!"}}')},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"attestat-back","version":"1.0.0","description":"mon attestat","main":"index.js","scripts":{"start":"node index.js","dev":"nodemon index.js","build":"webpack","swagger":"node ./utils/swagger.js","test":"echo \\"Error: no test specified\\" && exit 1"},"keywords":[],"author":"Zheenkulov Beknur","email":"d.zheenkul@gmail.com","license":"ISC","dependencies":{"@sentry/node":"^7.37.2","@sentry/tracing":"^7.37.2","axios":"^1.4.0","body-parser":"^1.19.0","compression":"^1.7.4","cookie-parser":"^1.4.5","cors":"^2.8.5","dayjs":"^1.11.8","dotenv":"^16.0.3","exceljs":"^4.4.0","express":"^4.17.1","express-fileupload":"^1.4.0","helmet":"^7.1.0","i18next":"^22.4.9","i18next-http-middleware":"^3.2.2","i18next-node-fs-backend":"^2.1.3","jsonschema":"^1.4.1","jsonwebtoken":"^8.5.1","pdfmake":"^0.2.7","pg":"^8.7.3","sharp":"^0.32.1","uuid":"^9.0.0","winston":"^3.11.0","xml2js":"^0.5.0"},"devDependencies":{"nodemon":"^2.0.12","swagger-jsdoc":"^6.2.8","swagger-ui-express":"^5.0.0","webpack":"^5.75.0","webpack-cli":"^5.0.1","webpack-node-externals":"^3.0.0"}}')}},r={};function t(i){var n=r[i];if(void 0!==n)return n.exports;var s=r[i]={exports:{}};return e[i](s,s.exports,t),s.exports}(()=>{const e=t(6860),r=(t(7806),t(9948)),i=t(7455),n=t(6674),s=t(9710),o=t(3582),a=t(1017),{corsOptionsDelegate:c}=t(208),{helmetConfig:u}=t(9800),d=t(7989),l=t(2986),p=t(5304),y=t(3148),g=t(7544),m=e();m.use(i()),m.use(o(c)),m.use(s()),m.use(e.json()),m.use(n()),m.use(p),m.use("/diploma",e.static("public")),"true"===g.FAKE_AUTH_MODE&&y.info("FAKE_AUTH_MODE = true"),m.use("/diploma/api/user",t(6340)),m.use("/diploma/api/register",t(94)),m.use("/diploma/api/shared",t(6184)),m.use("/diploma/api",l.isAuth,t(6559)),"development"===g.NODE_ENV&&m.use("/api-docs",r.serve,r.setup(d,{explorer:!0})),m.use("/*",((e,r,t)=>"/"===e.originalUrl?r.redirect("/diploma"):r.sendFile(a.join(__dirname,"public","index.html")))),m.use(((e,r,t,i)=>(y.error(`errorHandler => ${JSON.stringify(e)}`),t.status(400).json({error:!0,data:!1,message:e.message}))));const f=g.PORT||4e3;m.listen(f,(()=>{y.info(`Application listening on port ${f}`)}))})(),app={}})();